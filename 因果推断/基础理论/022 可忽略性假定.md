# 可忽略性假定的含义

$E(Y_i^1|D_i=0)$ 和 $E(Y_i^0|D_i=1)$ 都是反事实结果，是无法直接从数据中观察到的。

因此，我们在计算 ATT 的时候再次遇到了霍兰德所说的因果推断的根本难题。

针对这一难题，一个常见的解决办法是用 $E(Y_i|D_i=0)$ 作为 $E(Y_i^0|D_i=1)$ 的估计值，换句话说，就是用没有考上大学的人的平均收入去估计考上大学的人在没有考上大学这种反事实情况下的平均收入。

实际上一个人是否能考上大学和多种外界因素有关，包括他的社会地位，家庭经济文化资源。

很明显，上述的估计是建立在考上大学和没有考上大学的人在 $Y_i^0$ 上是完全可比这一假定上的，或者说两者在 $Y_i^0$ 是否可以完全忽略不计。

鲁宾将这个假定称作可忽略性假定。

如果要用公式来表示，要估计 ATT，我们需要假定：

$$Y_i^0 \perp D_i$$

其中，$\perp$ 表示相互独立，如果 $Y_i^0$ 和 $D_i$ 相互独立，那么必有：

$$E(Y_i|D_i=0)=E(Y_i^0|D_1=1)$$

同理，如果要求解 ATU，也有对应的可忽略性假定，结合起来，得到关于求解 ATE 的可忽略性假定：

$$(Y_i^0,Y_i^1)\perp D_i$$


# 观察研究及其偏差

基于观察数据，研究者可以计算出干预组和控制组在因变量上的均值，然后通过二者之差得到平均干预效应的一个估计量。
在相关的文献中，这个估计量一般被称为“幼稚估计量”。
从幼稚估计量这个称呼不难看出，该估计量在一般情况下并不是平均干预效应的无偏估计。

对一个样本数据而言，幼稚估计量的表达式为：

$$\hat \delta_{naive}=Ave(Y_i|D_i=1)-Ave(Y_i|D_i=0)$$
其中 `Ave()` 表示计算样本均值。

幼稚估计量的总体期望为公式：

$$E(\hat \delta_{naive})=E(Y_i|D_i=1)-E(Y_i|D_i=0)$$
将上面这个公式与如下公式进行结合
$$Y_i=D_i\times Y_i^1+ (1-D_i)\times Y_i^0$$
并通过适当变换，可以得到如下结果：

$$E(\hat \delta_{naive})=\delta_{ATE}+[E(Y_i^0|D_i=1)-E(Y_i^0|D_i=0)]+[(1-p)(\delta_{ATT}-\delta_{ATU})]$$

其中，
- $[E(Y_i^0|D_i=1)-E(Y_i^0|D_i=0)]$ 是干预前异质性，
- $[(1-p)(\delta_{ATT}-\delta_{ATU})]$ 是异质性干预效应。
上述公式清楚地展示了通过幼稚估计量估计 ATE 时会产生的两种偏差。

第一种偏差来源于公式： $[E(Y_i^0|D_i=1)-E(Y_i^0|D_i=0)]$ ，其含义是干预组个案和控制组个案在 $Y_i^0$ 上的平均差异，因为 $Y_i^0$ 发生在干预之前，所以这种偏差也被称作干预前异质性（pretreatment heterogeneity）。

在经济学研究中，**干预前异质性也被称作选择性偏差**，选择性意味着不同的人进入干预组和控制组的机会是不同的，这种机会上的差异导致对因变量进行简单比较会系统性地高估或低估干预的真实影响。

第二种偏差来源于公式：$[(1-p)(\delta_{ATT}-\delta_{ATU})]$ ，它是两个项的乘积。
- 第一项是控制组个案占总体的比例，这里的 $p$ 可通过公式 $p=P(D_i=1)$ 计算得出。
- 第二项是 $\delta_{ATT}$和$\delta_{ATU}$ 之差，这是决定第二种偏差是否为 0 的关键。如果个体层面的干预效应在干预组和控制组不存在系统差异，那么这一项就为 0，进而第二种偏差也为 0；反之，第二项偏差就不等于 0。
- 由于第二种偏差取决于干预效应本身在不同组之间的异质性，因此这种偏差也被称作异质性干预效应偏差（differential treatment effect bias）。

经济学家认为，导致这种偏差的**主要原因是自选择**，如果人们预计到干预对自己的积极影响较大，就有较强的动力进入干预组，反之则倾向于留在控制组。

综上所述，通过幼稚估计量来估计 ATE 会受到两种偏差的威胁。只有在既不存在干预前异质性，也不存在异质性干预效应的情况下，幼稚估计量才是 ATE 的无偏估计。

回顾之前对可忽略性假定的介绍，可以发现，如果 $Y_i^0$ 、 $Y_i^1$ 和 $D_i$ 相互独立，即当可忽略性假定成立的情况下，这两种偏差都会变成 0。
- 首先，如果 $Y_i^0$ 和 $D_i$ 相互独立，可以直接推论出干预前异质性为 0。
- 其次，如果 $Y_i^0$ 和 $Y_i^1$  都与 $D_i$ 相互独立，那么$Y_i^1- Y_i^0$  必然也与 $D_i$ 相互独立，这意味着个体层面的干预效应 $\delta_i$ 与 $D_i$ 相互独立，在这种情况下，ATT 和 ATU 也必然相等，因此异质性干预效应也不存在。

由此可见，满足可忽略性假定是使用幼稚估计量推断因果的前提条件，但是，这个假定在观察数据中是很难得到满足的。

鲁宾认为，可忽略性假定不满足意味着 $D_i$ 的分配不是随机的，这时，需要基于理论对 $D_i$ 的分配过程建模。

如果 $D_i$ 的取值受一组可观测变量 $X$ 的影响，且排除 X 的影响后，$D_i$ 中的剩余部分 $Y_i^0$ 和 $Y_i^1$ 条件独立，那么可以得到一个相对较弱的可忽略性假定，具体如下：

$$(Y_i^0,Y_i^1)\perp D_i|X$$
这个假定意味着，通过恰当的统计控制，可以得到平均干预效应的无偏估计值。

但是到这里，还有两个问题没有解决：
- 一是控制什么？这个问题需要借助 pearl 提出的 [[第三章 因果图]] 才能得到较为充分的回答。
- 二是怎么控制？