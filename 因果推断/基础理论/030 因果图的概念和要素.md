#定义 #guide 
因果图以图形方式呈现因果系统中不同变量的关联规则，这在直观上与20世纪90年代流行的配套于[[结构方程模型]]的路径图（path diagram）十分类似。

然而，不同于结构方程模型中每条路径对应一个线性回归系数，因果图中不同变量间的路径关联是非参数的。换言之，因果图仅表现变量间是否存在关系，不指定这些关系的具体形式。

这便赋予了因果图更为自由的表达形式和更加贴近现实的预设基础，这正是因果图的妙用所在。

# 因果图的元素与基本构型

因果图由三项元素构成：节点、线段和箭头。

**节点代表特定的变量：**
- 这里使用 $T$ 表示解释变量（干预变量），
- $Y$ 表示被解释变量（效应），
- $X$ 表示信息可被获取的相关变量，
- $U$ 表示信息不可获取的相关变量。

线段代表两变量之间存在因果关联，而箭头则代表由“因”及“果”的方向。

需要注意的是，当图中任意两个变量间不存在箭头线时，代表两变量之间不存在因果关系，这是一项**相当强的排斥性约束**，需要研究者以**足够的理论信心和经验证据作为支撑**。

## 因果图细分类型

![[因果图示意.png]]

这里的因果图专指开环有向图（directed acyclic graph，DAG）。

所谓“有向”是指存在于两变量间的连线均以箭头指明从因到果的方向。

而“开环”是指任何一条以特定变量为“因”的变量，都不会再指向到改变量。

这一规则背后的逻辑在于，任何“因”与“果”之间都存在先后次序，“因”必须先于”果“发生。

这也意味着因果图无法直接地表达社会科学研究中常见的互为因果问题（[[联立性偏差]]） ，如个体的身体健康程度和收入水平之间可能存在相互促进的作用。

互为因果并不代表因与果真的同时存发生，而是所使用的实证材料无法区分变量发生的先后，其解决有赖于改善实证材料、改进研究设计或改变问题假设。

因果图中能够链接两个变量的所有方式称为通路（path），通路中不考虑箭头的方向，但每个变量最多只能出现一次。

通路的存在表明两变量之间具有相关的可能性，但具体通路是否能传导相关则依赖与后面将介绍的通路开启/阻断规则（law of unblock/block）。

与之对应的是亲子变量关系，当一条通路中包含的所有箭头方向一致，则处于路径源头的变量为“亲代变量”，处于路径末端的变量为“子代变量”。

因果图是一种非参数估计工具。有别于结构方程模型中指定不同变量间存在线性相关的假设，因果图中不预设变量参数的性质或变量相关性的统计推断形式。

因果图的非参数性质意味着它在分析变量之间的关系时，**不依赖于任何预设的数学形式或统计分布假设**。具体来说，这有以下几层含义：

- **不预设线性关系：** 传统的结构方程模型通常会假设变量之间存在线性的因果关系，例如，Y=β0​+β1​X+ϵ。这意味着每单位 X 的变化都会导致 Y 以一个固定比例 β1​ 变化。而因果图则不作此假设。它允许变量之间存在任意形式的关系，无论是线性的、非线性的、阶梯式的，还是其他更复杂的形式。这使得因果图在处理复杂现实世界数据时更具灵活性和普适性。
- **不预设参数性质或统计推断形式：** 这意味着因果图不要求你指定变量之间的关系是正相关、负相关、增强效应还是抑制效应，也不关心这些关系的具体数值（即参数）。它更侧重于识别和表示**因果路径**，以及这些路径如何被其他变量（如混杂因子、中介变量、对撞因子等）影响。因果图主要用于**识别因果关系的可识别性**（identifiability），即在给定数据和假设下，我们能否从数据中估计出我们感兴趣的因果效应，而不需要预设效应的具体大小或统计分布。
- **侧重于结构和假设的清晰表示：** 因果图（如**有向无环图, DAGs**）通过图形化的方式清晰地表示了研究者关于变量之间因果关系的**假设**。每个节点代表一个变量，箭头则代表假定的因果方向。这有助于研究者和读者直观地理解复杂的因果结构，并识别潜在的偏误来源（例如混杂偏误、选择偏误等）。这种图形化的表示使得研究者能够：
    - **识别需要控制的混杂变量：** 通过“后门路径”等概念，因果图能清晰地指出哪些变量是混杂因子，必须加以控制才能得到无偏的因果效应估计。
    - **理解变量之间的复杂交互：** 例如，区分中介效应和调节效应，以及识别对撞因子（collider）等特殊结构，这些结构在不使用因果图时容易被忽视或错误处理。
- **更适用于因果推断的“识别”阶段：** 结构方程模型通常用于“估计”阶段，即在确定了模型结构后，用数据来估计参数值。而因果图则在更早的“识别”阶段发挥关键作用。它帮助研究者在进行任何数据分析之前，先确定理论上某个因果效应是否可以从可观测的数据中推断出来，以及需要满足哪些条件（例如，需要控制哪些变量）。

无论多么复杂的因果图，均由三种最基本的构型组成。
![[因果图的三种构型.png]]
- 其一为链状（chain）构型，位于三个变量间的两处箭头方向一致。
- 其二为叉状（fork）构型，即以同一个变量A为源头延伸出两条箭头线，同时指向变量B和C，将之称为“共因”结构，此状态下**变量A是变量B和C的混杂变量**。
- 其三为反叉状（inverted fork）构型，变量A和B同时指向变量C，变量C即为变量A和B的“共果”，此状态下的**变量C被称为A和B的对撞变量**。

# 变量省略规则

现实情景中，因果关系通常涉及许多相关变量，如果把所有的变量都纳入因果图，不仅节点庞杂，箭头繁复，必然会影响图形的可读性。

事实上，不是所有的变量都必须呈现于因果图上。

首先，需要指出的是，因果图中的某个节点可能代表多个变量组成的变量矩阵，而不仅仅是单个变量。

其次，对于因果图中涉及的变量应当在何处“适可而止”，仍需回归到其背后的数学表达来看。

实际上，在珀尔的设计中，每一个变量背后都有一个误差项 $e$ ，对应代表由缺失其他变量所致的误差。

这些缺失的变量相对于因果图中包含着其他变量边际独立，代表在考虑因果图中相关变量信息之后该变量仍不能被解释的部分。

换言之，对因果图中包含的特定变量，图中其他与该变量相关的变量加上该变量自身对应的误差项 $e$ 就可以完整覆盖该变量的信息。