# 相关性及偏差来源

因果图的一项突出优势在于其能够清晰呈现系统中变量相关性与因果推断偏差的来源。更为巧妙的是，相关性与偏差之源又严格对应于因果图的三种基本构型，使研究者能够方便地掌握系统而条贯的理解框架、清晰而严谨的分析工具。两个变量间的相关性从何而来？因果图中显示如果两个变量之间存在相关关系，不论相关为线性还是非线性，其来源有且仅有三种可能，而这三种相关性之源如果处理不当又会诱发三种对应的偏差。

但是，在探讨这些问题之前，首先要厘清的是对“控制”这一概念的理解。中文语境下作为量化术语的“控制”一词实际上对应了英文中“control”和“condition”两词，但英文中这两个词的所指存在一定的差别。前者多指将特定变量纳入回归模型，这也与当前中文里“控制”一词的使用一致；后者则具有更广泛的涵义，即控制的本质是以特定形式将某项变量的信息引入分析过程，以实现针对特定群体的分析。此处，分析过程不再限于回归模型，所用形式也不止纳入控制变量。其他控制方式包括基于个体特征进行分层、基于特定条件选择样本等，因果图中的“控制”概念即指这种“广义的控制”。在因果图中以使用方框“□”符号圈住特定变量来表现该变量以某种形式获得控制。

了解因果图中“控制”的涵义之后，即可讨论变量相关性与因果推断偏差的来源。因果图允许研究者以直观的形式呈现三种相关性和偏差对应的情形，如表1所总结。

![[三种偏差来源与解决方式.png]]

1. 因果关系带来相关

第一，两变量间如果存在因果关联则能够带来相关性。当两变量之间存在因果关系时，“T能够导致Y”本身就意味着两者间存在相关性，而确定这一关系是因果推断的根本目标。值得提及的是，因果图中两个变量间的因果关系可以直接用箭头线表示，如图1左图中的T→C和C→Y；也可以是经中介变量传导的链状构型，如T→C→Y中，尽管间隔了变量C，但T仍然是Y之“因”。这在社会科学实证情境中也很常见，例如“学习能力→高考成绩→考入大学”之间，学生需要通过高考成绩进入大学，高考成绩在学业表现和考入大学之间充当了中介变量，但仍不妨碍较高的学习能力与考入较好的大学之间具有清晰的因果关联。然而，如果链状构型中存在中介变量，也存在产生偏差的可能，即对中介变量的过度控制。这一情况指的是由于错误地控制了中介变量，阻断或削弱了变量间真实的因果效应。表1中绘制了过度控制对应的因果图情况，由于变量A与C之间的因果效应依赖B传导，控制变量B后即消除了A和C之间存在的关系，进而会错误估计A和C之间不具有因果效应。

2. 混淆变量带来伪相关

第二，对应于叉状构型，当两变量间存在“共因”时，则在统计学上体现相关关系。也就是说，尽管图2(b）中B、C两变量之间不存在因果关系，但由于同时受到混淆变量A的影响而表现出统计学相关性。典型案例为俗语“一打雷就下雨”，从气象成因的角度，打雷并非下雨的原因；但如果记录打雷和下雨同时出现的频率，则呈现高度的相关。这种相关性之所以存在，在于打雷和下雨具有相同的原因（如湿度达到一定水平形成积雨云等）。对于希望确定变量间因果关系的实证社会科学研究来说，如不加分辨和处理，此类相关关系可能误导研究者得出两变量之间存在因果关系的结论，因而被称为伪相关。这是因果推断中最常见的一种偏差来源。此时，如表1所示，如果控制混淆变量A，则B、C两变量间的相关性被消除。其原因在于，既然变量A是导致B、C之间存在相关性的原因，那么将变量A的信息引入系统后，相当于将样本按照变量A的取值划分为特定数量的小组，对变量B、C关系的探索发生于各小组内部。此时，变量A的因素被消除，B、C之间的伪相关将不复存在，这也是定量研究中加入控制变量的原因所在。

3. 控制碰撞变量诱导伪相关

第三，对应于反叉状构型，如图2(c）中当A、B两变量之间不存在因果关系，仅有一个作为“同果”的碰撞变量C时，A、B两变量间本身不会因变量C的存在而具有相关性。然而，将变量C控制之后，变量A与B之间会出现伪相关。与因存在混淆变量导致伪相关的情况不同，因控制碰撞变量造成伪相关的过程较为抽象，本文引用埃尔韦特与温什普所举的好莱坞演员的例子进行说明。为便于讨论，首先预设就人群整体而言，个人的才气和相貌间不存在关联，即两者间既无任何方向的因果关系，也不存在作为“共因”的混淆变量。其次，一项合理的预期是过人的才气和姣好的相貌都能正向提升个体成为好莱坞演员的概率。套用图2(c）的构型，则A、B两变量分别对应个体的才气和相貌，变量C为是否能成为好莱坞演员。那么，当控制作为碰撞变量的C后，如只考虑那些成功成为好莱坞演员的个体，当已知该演员才气平庸时，那么基于此人能够成为演员的事实可以推断其有极高概率相貌出众；反之，如果已知某演员相貌普通，可以合理推测其应当拥有过人的才华。因此，尽管个体才气和相貌这两项先赋因素本身不具有任何因果关系，但在好莱坞演员这一特定人群中，两变量会呈现反向的伪相关性。这种由于不当控制碰撞变量所产生的偏差被称为内生性选择偏差。

摩根和温什普使用蒙特卡罗法模拟了大学申请者的SAT7成绩和面试得分情况——两项决定申请者能否被录取的主要指标，并预先赋予两者间一个系数为0.035的正向相关；随后，分别在模拟样本中检验录取和未获录取的两个群体内部个体SAT成绩和面试得分的关系。研究发现，被录取者的SAT成绩与面试得分的相关系数为-0.64；而在未被录取的群体中，两变量的相关性为-0.23。这一结果直观地揭示了对碰撞变量的不当控制可能带来严重的偏差，甚至得出完全错误的结论。根据流行病学等领域的学者对内生性选择偏差影响的评估，当碰撞变量为二元变量时，如果错误控制碰撞变量，引入的偏差幅度通常与未能控制混淆变量的影响相当。这说明在实证研究中，内生性选择偏差问题不容忽视。然而，不同于因遗漏混淆变量导致的伪相关，因控制碰撞变量引起的伪相关的方向和程度均依赖于具体情境，不存在简洁通用的判断方式。最后，控制碰撞变量的子变量同样会诱发伪相关问题，其效果与直接控制碰撞变量相同。如表1所示，其解决方式是认清系统内存在的碰撞变量，并尽量避免控制这些变量。事实上，内生性选择偏差在社科实证研究中很常见，埃尔韦特与温什普在论文中列举了大量社会学案例，本文后续也将在不同情境下对此问题做更详细的讨论。

# D分隔法则

在三种基本构型中单独区分偏差来源相对容易，但具体的因果图往往包含更多的相关变量和更为复杂的指向关系，要辨识出哪些通路应当被干预、哪些变量应当被控制则较为复杂。为此，珀尔总结出D分隔规则来辅助判断。在因果图中，当一条通路满足以下条件时，则通路两端的变量之间不具有相关性：

(1）通路中存在一个被控制的混淆变量或中介变量（对应表1中“混淆变量的消除偏差状态”和“过度控制的产生偏差状态”）；

(2）通路中存在未被控制的碰撞变量及其子变量（对应表1中“内生性选择偏差的消除偏差状态”）。

此时称该通路被阻断，或实现了D分隔。反之，当以上两条件均不满足时，该通路为开启状态，两端的变量间存在相关性。由此可知，取决于特定变量在某个通路中扮演的角色，控制该变量对其所处的通路有迥然不同的影响：当该变量为碰撞变量时，控制碰撞变量会开启原本被阻断的通路；反之，控制并非碰撞变量的变量会关闭通路。

在因果推断过程中，基于D分隔法则，研究者需要阻断解释变量和被解释变量间的所有非因果通路，同时保障所有因果通路均为开启状态。

本文参考格林兰等人论文中一则因果图案例并解释运用D分隔的具体分析过程。如图3所示，假设D代表使用社会关系，E代表个体的收入，C为个人魅力，A为性格，B为相貌颜值。要测量使用社会关系是否影响到个体收入，需要排除除了D直接到E的因果通路之外其他所有通路的干扰。值得注意的是，此图中代表着个人魅力的变量C本身是解释变量D与被解释变量E的混淆变量，又是个体性格A和相貌B的碰撞变量，而性格和相貌又与变量D和E相关。那么，要想测量出D和E之间的因果效应需要控制哪些变量呢？

![[因果图运行示例.png]]

首先罗列D和E之间所有非因果通路共计四条：
- (1)D←A→C←B→E，
- (2)D←A→C→E，
- (3)D←C←B→E，
- (4)D←C→E。

此时，个体魅力C在通路2、3、4中分别为中介变量和混淆变量，因而控制这一变量就能够阻断这三条通路。但问题在于，个体魅力又是通路1的碰撞变量，意味着当控制个体魅力后反而会开启通路1并带来新的偏差。因此，必须寻找通路1中的中介变量或混淆变量来阻断该通路，而个体性格A和相貌B均满足该条件。同时，由于变量D和E为直接因果关系，不存在被过度控制阻断的可能。因此，就图3而言，需要同时控制变量C和A，或C和B，或C、A和B才能满足非因果通路的D分隔条件；若只控制变量C会带来内生性选择偏差。