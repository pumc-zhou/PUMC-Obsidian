#内生性 #guide #定义 

本部分尝试基于因果图视角重新审视并解读传统因果分析中关注的元素，进而将因果图与现有因果知识框架融合起来。接下来，第一小节讨论如何用因果图理解传统因果分析中的四类内生性问题；第二小节用因果图呈现一些主流因果推断方法的运行逻辑和适用场景。
# 理解内生性问题

传统因果效应框架下，内生性问题源于多元线性回归设定中的零条件均值假设（zero conditional mean）。该假设要求在给定所有控制变量的情况下，多元线性回归中误差项 u 的条件期望为0：

如该假设满足，则称相关控制变量为外生的；若该假设无法满足，即解释变量或控制变量中存在xj与误差项u相关时，即为内生性解释变量，由此带来的就是内生性问题。回顾本文第一部分对哪些变量应当被纳入因果图的讨论（图1右图），其条件为当某个变量对应的误差项与因果图中其他变量均无关时，该误差项中的因素就不必显示于因果图中。可见，不再指定具体回归形式之后，外生性条件与因果图中的变量筛选条件是一致的。也就是说，一幅完整的因果图应能对应地呈现所有内生性问题。陈云松、范晓光将由内生性导致的相关问题汇总为四类，包括遗漏变量、自选择、样本选择和联立性。本小节即在此框架基础上探讨如何使用因果图方法理解这些问题。

## 遗漏变量偏差

遗漏变量偏差指的是回归模型中存在本该被控制却未被控制的变量，与因果图中因混淆变量造成伪相关的情况相对应。陈云松、范晓光曾在研究中举例，在探讨找关系和职场成功间的因果效应时，因未控制个体口才导致推断存在偏差。基于因果图的框架不难发现，“个体口才”充当了混淆变量的角色。如图4(a）所示，根据经验推断，一个人的口才会影响其对社会关系的应用情况；同时，口才作为能力的一个维度，也会影响到个体是否能在职场上取得成功，这就形成了典型的叉状构型。此时，即使假设找关系与职场成功之间不存在因果关系，但如果不控制混淆变量“个人口才”，也会因未能阻断解释变量和被解释变量之间的伪相关而得出“找关系能够影响职场成功”的错误结论。

## 自选择偏差

自选择偏差同样归结于因果推断中的叉状构型。自选择指的是个体因自身原因选择某些行为或参与到特定项目中，即干预变量并非随机分配的。伍德里奇使用两个案例来说明自选择问题：在探讨个体饮酒行为对收入的作用时，伍德里奇强调可能存在一些个体特征，既决定了个体是否饮酒，又影响到个体的收入水平；其二为参与培训项目对学生成绩的影响，学生能否参与培训项目与其家庭背景因素（如父母受教育程度、家庭收入水平等）有很大关系，而家庭背景又会影响到学生成绩。这两个案例同样是因果图中典型的叉状构型。陈云松、范晓光在研究中强调自选择中被遗漏变量的非观测因素特征，恰与文初变量标志定义相关。仍使用X表示能够被观测到的变量，U表示难以观测但同时影响解释变量和被解释变量的因素。尽管面临的都是混淆变量干扰的问题，但相较于图4(b），图4(c）图中的伪相关更难消除。因而，相较于一般的遗漏变量问题，自选择带来的偏差通常更难解决。

![](https://imagepphcloud.thepaper.cn/pph/image/208/961/539.jpg)

## 样本选择偏差与非随机缺失值

样本选择偏差是相对更为复杂的一种情形。陈云松、范晓光的研究将其解释为“因变量的观察仅仅局限于某个有限的非随机样本”，即样本能否被观察到取决于其解释变量的取值，在计量教材中有时也被称为内生性样本选择。伍德里奇曾举例，在讨论个体教育对收入水平的影响时，仅关注那些收入水平在特定条件下的人群（如年收入十万以上者），得到的教育对收入的影响与在整个人群中的实际影响程度不同，这是典型的样本截断问题。应用因果图框架，考虑系统中存在一些不易被观测的因素（如个体智力等）会同时影响个体的受教育水平及未来收入。如前文所述，这些因素本身作为混淆变量，在不能被有效控制的情况下会带来偏差。但是，当所用样本基于因变量信息被截断后，系统中会存在另一种由碰撞变量带来的偏差。如图5(a）所示，被解释变量个体收入水平是受个体智力和教育水平同时影响的碰撞变量，在以“年入十万”为标准对人群分层之后，实际上开启了另一层个体智力与教育水平之间的伪相关关系。由此带来的双重相关无法真实反映个体教育和收入水平间的真实关系。

进一步而言，无论是否存在遗漏变量，基于因变量的样本截断总会给系统带来偏差。不妨将案例中的个体智力换作彩票是否中奖，一项与个体受教育程度无关却直接影响到个体收入水平的因素，在一般的回归过程中这样的变量并不需要被控制。如图5(b）显示，尽管不存在混淆变量，但由于作为被解释变量的个体收入水平充当了教育水平和彩票中奖的碰撞变量，当系统通过样本截断控制了个体收入水平后，会开启教育水平和彩票中奖间的伪相关。此时，除了个体教育和收入水平之间本身存在的因果关系外，还加上了一条“教育水平→彩票中奖→收入水平”的伪相关。在此情况下，个体教育和收入水平间的相关程度同样不等于因果效应。事实上，可以将“彩票中奖”看作与解释变量“教育水平”无关的误差项的一部分，而被解释变量永远会是解释变量和对应误差项的碰撞变量。由于实践中不可能穷尽构成误差项的所有因素并加以控制，所有基于被解释变量的截断操作均会引入内生性选择偏差带来的伪相关。

此外，伍德里奇将社会调查中常见的缺失值问题视为内生性样本选择的一种特殊形式，而这一问题也可以通过因果图的内生性选择偏差视角来解读。当缺失值的出现与任何变量均无关，即完全随机时，缺失值的存在并不会对该调查的效度产生影响。然而，当缺失值与特定变量间存在关联时，就可能影响到结果的有效性。如一项新近的研究尝试基于首都大学生社会调查提供的其他变量信息，使用机器学习算法预测缺失样本的真实性取向。借助因果图框架，可以清晰地理解这项工作的意义。如图5(c）所示，假设需要使用该社会调查探讨个体性取向对精神状态的影响。由于社会偏见与歧视的存在，合理的推测是，相较于异性恋个体，性少数个体更倾向于拒绝回答有关性取向的问题，导致相关问题的缺失值与个体真实性取向之间存在关联。同时，假设个体精神状态对是否回答问卷中的相关题目也有影响，那么问卷样本值是否缺失会成为样本性取向和精神状态的碰撞变量。如果在分析过程中不考虑这一关系而直接使用未缺失的样本，就会开启反叉状通路，造成解释变量与被解释变量间存在额外的伪相关。在此情况下，仅考虑个体性取向和精神状态间的相关程度不但不能反映两者间的真实因果效应，甚至可能得出与事实相悖的结果。假定性少数群体或精神状态较差的人群更倾向于拒绝回答相关问题，则在已知样本值不缺失的前提下，选择回答问题的性少数个体更可能具有较好的精神状态（否则不会去回答问题）；反之，如果精神状态较差，则更可能是异性恋人群。在这种伪相关性的干扰下，研究者可能得到与真实情况相反的结果。尝试对缺失值进行精准预测的工作即意在解决此类内生性选择偏差。假设在最理想的情况下，样本性取向缺失值的真实信息能补全，则图5(c）中由性取向到样本缺失值的箭头线就不复存在，进而提升该项社会调查的有效性。综上，陈云松、范晓光提及的“样本选择偏差”或伍德里奇的“内生性样本选择”与因果推断中讨论的“内生性选择偏差”的涵义相叠，因果图能够以更为直观和规范的形式呈现这一问题。

![](https://imagepphcloud.thepaper.cn/pph/image/208/961/541.jpg)

## 联立性偏差

陈云松、范晓光曾在研究中谈及第四种偏差是因联立性或双向因果而产生的。前文已提及，真正的“因”与“果”之间必然存在时间的先后次序，所谓的两变量X和Y互为因果，其真实涵义是“X能对随后发生的Y产生影响，反之Y也能影响到随后发生的X”。也就是说，联立性偏差源于数据的精细程度不足而无法区分出变量发生的次序，根本的解决方法是引入更精细的时间次序。在开环有向形式的因果图中不允许两变量之间存在双向箭头，但可以通过在变量后添加角标来表示时间次序。如图6左侧所示，代表着直观上“联立性”的左图与“开环”的要求不符，因而不会出现在因果图中；图6右侧部分则通过加入角标的方式，将同一变量细分为不同时段。尽管干预T和效应Y互有影响，但只是体现在T1对Y2和Y1对T2的作用上，处在同一阶段的T1与Y1，T2与Y2之间并不存在直接的因果作用。此外，同一变量在不同时间段存在趋势延续性，因而T1向T2和Y1向Y2也存在箭头连接。需要注意的是，图中仅截取了变量在两个时间段的相互作用情况，更前面的时间段并未在因果图中呈现，真实的因果图状态应该是沿时间趋势以类似结构不断延伸的。加入时间角标后，因果图中通路的开闭规则仍然适用。就图6右侧部分来看，若评估T1→Y2的因果效应，则需要保持以下路径关闭：T1←X→Y2，T1←T2←Y1→Y2，T1←Y0→Y1→Y2，T1←T0→Y1→Y2（未显示于图中）。根据D分隔规则，这些路径均可通过控制X和Y1加以阻断。需要再次强调，因果图能够帮助研究者规划解决联立性问题的思路，但能否实现则取决于数据的质量。

![](https://imagepphcloud.thepaper.cn/pph/image/208/961/542.jpg)

基于以上讨论，表2汇总了传统因果分析中内生性问题与因果图中偏差类型的对应情况。遗漏变量与自选择偏差均对应着因果图中的混淆偏差。样本选择偏差及其特例非随机缺失值归属于因不当控制碰撞变量而诱发的内生性选择偏差。联立性偏差本质上是数据质量问题，但在因果图中通过角标区分时间次序也能予以表达。最后，对中介变量的故意控制多出现在机制探讨中，因而通常不被视为偏差的来源，但当研究者对变量角色的认知不甚明确时，也有可能导致过度控制问题。

![544.jpg](https://imagepphcloud.thepaper.cn/pph/image/208/961/544.jpg)

# 因果图框架下的计量方法

现有因果推断方法主要解决因存在混淆变量导致的混淆偏差问题。基于混淆变量能否被观测到需要采取不同的对策。当混淆变量能够被观测到，消除偏差的方法就是在系统中控制这些混淆变量，常用做法包括多元回归和匹配；当存在无法被控制的混淆变量时，研究者面临着更为复杂的情境，需要根据情况选择寻找代理变量、实验或准实验、工具变量、面板模型、断点回归、双重差分等方法。

其中，多元回归与匹配或倾向值匹配的方法均通过在系统中控制已知的潜在影响因素来消除混淆偏差。因此，尽管摩根和温什普将这两种途径区分为控制直接影响自变量分配的因素和对影响因变量的其他因素进行分层，但两种方法的作用逻辑和预期效用是一致的，对应的因果图均如图7(a）。

当系统中存在无法直接观测的因素时，如果这些因素的涵义比较明确，最直接的方法是寻找替代变量。如在社会科学研究中，经常使用考试成绩代表个体的认知能力，使用自评心理状况量表代替心理健康程度等。然而，如果代理变量不能完全反映对应的因素，仍会有部分混淆偏差遗留在系统中，如图7(b)(c）所示。

![546.jpg](https://imagepphcloud.thepaper.cn/pph/image/208/961/546.jpg)

其次，如果条件允许，理论上，使用随机实验能得到最可靠的结果。如图7(d）中，由于干预因素是随机分配的，即使存在其他影响被解释变量的因素，也不会与自变量构成伪相关通路。此时，解释变量与被解释变量之间的相关程度直接反映了两者间的因果作用。这也是基于实验所得的结论往往被视为黄金标准的原因。

工具变量是另一种常用的因果推断方法，它的基本逻辑是寻找一项完全外生的因素仅通过直接作用于自变量而影响因变量，进而估算自变量中直接受外生变量影响的部分对因变量的作用程度，图7(e）中的变量I即为工具变量。对工具变量具体机制的解读可参考相关研究。图7(e）同时反映了一个重要信息：尽管工具变量I仅通过解释变量T作用于被解释变量Y，但控制T后I与Y仍存在相关性。这是由于解释变量是工具变量与混淆变量的碰撞变量，控制解释变量后会开启I→T←U→Y的通路。因此，尽管工具变量与被解释变量间的通路完全由解释变量介导，但在实践中不能通过控制解释变量后测试工具变量与被解释变量是否仍然相关来判别工具变量的有效性。这也解释了为什么工具变量的外生性无法用统计方法来证明。

最后，图7(f）简要展示了面板模型的逻辑，参考上节的分析，通过控制所有混淆变量以及Y1能够阻断所有由T1到Y2的非因果通路。在实践中控制解释变量滞后项的做法为动态面板模型。如果预设系统中前一阶段的被解释变量对后续阶段被解释变量不存在直接影响，模型中不必纳入被解释变量的滞后项，此时为静态面板模型。

当系统中存在内生性选择偏差时，相对易于处理的情况是通过避免控制碰撞变量或阻断伪相关通路来消除内生性选择的影响。如果对碰撞变量的控制是由数据或系统本身导致时（如样本截断、缺失值、特定样本群体等），碰撞变量带来的偏差就无可避免。针对此类问题，赫克曼二阶段法是社会科学研究中应用最为广泛的纠偏途径。此外，一些新方法也在被不断提出或改进。更为彻底的方式则是提升数据质量或变更问题形式。就内生性选择偏差而言，最重要的是准确判断是否存在碰撞变量、能否避免开启伪相关以及会不会影响到因果推断的效度，这些均是因果图能够助力之处。

# 使用因果图厘清模糊认知

因果图作为一种直观严谨的图像化表达系统，能够帮助研究者澄清一些长期存在于实证社会科学研究中却不甚准确的观点。本文以“控制发生在干预后的变量会低估因果效应”和“发生在干预之前的变量应当加以控制”两种流传甚广的观念为例加以说明。

## 控制干预后变量未必带来偏差

计量课程常以图8(a）为示意来讲解回归模型中控制变量的选取。其中，X代表人口学变量等先赋因素，B则为发生于解释变量后的变量。一般会建议控制X类变量而避免控制B类变量，理由是控制B类变量会分散部分自变量对应的回归系数，并低估自变量与因变量之间的真实作用。

然而，基于图8(a）中的信息，B类变量与因变量Y之间不存在直接的因果关系，仅因同受解释变量T的影响而具有统计学层面的相关。如果此条件严格成立，是否控制变量B对回归结果均不存在影响，解释变量与被解释变量的关联系数也不会被B分散。不妨以这样的视角来理解：首先关注B和Y的关系，两者间不存在直接的因果关系，仅有“B←T→Y”和“B←T←X→Y”两条通过混淆变量传导的通路诱发两者间的伪相关。而对这两条通路，控制变量T即可将其完全阻断，此时B与Y之间是条件独立的。那么，在多元回归的情况下，模型中本身包含了解释变量T，此时再将变量B作为控制变量纳入模型，B对应被解释变量的回归系数只会是0，不会对回归结果产生任何影响。事实上，要使变量B对T与Y间的因果效应产生影响，则在B与Y之间必须存在另外的不经T介导的关系。在变量B不应被控制的论断背后，实际上存在着两种不同的情境。

如图8(b1)(b2）所示，如果B和Y之间存在直接关系，可能由Y导致B，或者由B导致Y。这两种情况下均不应当控制变量B，但其所基于的理由和导致的后果却明显不同。当出现（b1）中的情况时，此时B是T和Y的碰撞变量，控制B会导致T→B←Y通路开启，造成T和Y之间的伪相关，影响对两者间真实因果关系的判断。但是，这种影响的方向和程度依赖于具体情境，无法一概而论。而在（b2）情境中，B作为中介变量介导了一部分由T到Y的因果效应，控制变量B后会导致对T与Y之间真实因果效应的低估——在这一情况下“控制变量B将分散自变量的回归系数”的说法才会成立。研究者在聚焦于对具体机制的探索时，有时会刻意选择控制中介变量来区分直接和间接因果效应。

此外，值得澄清的一点是，仅基于解释变量或被解释变量一边做出的样本选择并不会导致偏差的产生。图8(a）中控制变量B的做法可被视为对解释变量T进行了选择，但由于这种选择与变量Y不产生直接的关系而不会影响到T与Y之间的因果效应，伍德里奇称此为外生性样本选择。不妨用一种理想化的极端情况进行说明：图8(c）中分别以是否下雨和彩票中奖为干预和效应，而这两者本身是不存在任何关联的。控制干预为“下雨天”不会影响彩票中奖的概率；控制效应为“中奖”的条件下，当天是否下雨也与具体的彩票获奖金额无关。现实情况中，基于解释变量或被解释变量的选择往往会对因果推断造成影响，其本质在于这些选择会以某种方式影响到另一边，而非真正的完全无关。

## 控制干预前变量可能引起偏差

尽管流行观念认为当特定变量发生在解释变量之前时，应当在系统中加以控制以消除偏差，但这样的操作同样存在风险。事实上，一些碰撞变量同样可能发生在解释变量之前，如果不加甄别，会诱导内生性选择偏差。埃尔韦特与温什普采用一项社会网络案例加以说明。

图8(d）希望探讨个体 $j$ 在时间 1 的社会参与是否会影响到与其熟识的个体 $k$ 在时间 2（时间1之后）的社会参与程度。其中 $U$ 代表相关个体特性如外向程度，这种特性显然会影响到个人交友情况，同时影响到个人的社会参与情况；$F_{j,k}$ 代表两个体间存在社会关系，这种关系发生在观测时间1和2之前。此时，即使假设 $Y_{j1}$ 与 $Y_{k2}$ 不具有直接的因果效应，但由于个体间存在社会关系是先验的，故“$Y_{j1}←U_j→F_{i,j}←U_k→Y_{k2}$ ”通路开启， $Y_{j1}$ 与 $Y_{k2}$ 之间具有伪相关。这也是社会关系领域区分“物以类聚”和“近朱者赤”两种效应时面临的主要挑战。